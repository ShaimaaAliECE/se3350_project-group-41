<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Home</title>
		<link rel="stylesheet" href="mystyle.css">
	</head>
	<body>
		<h1>Start the tutorial</h1>
		<!--input type="button"  onclick="ShowLine()" value="Display Level 1" /-->
		<button type="button" class = "button" onclick="window.location.href='level1.html'"> Level 1 </button>
		<div>Enter your name: </div>
		<input type="text" id="name" name="name"><br><br>
		<button type ="button" onclick="submitName()">Submit Name</button>
		<table class ="tb" id ="scoreboard" width = "400" height = "100"> 
			<tr>
				<td>NAME       </td>
				<td>LEVEL 2 SCORE</td>
				<td>LEVEL 3 SCORE</td>
				<td>LEVEL 4 SCORE</td>	
			</tr>

		</table>
		<!--body>button type="button" onclick="window.location.href='level2.html'"> Level 2 </button>
		<button type="button" onclick="window.location.href='level3.html'"> Level 3 </button>/-->
	</body>
</html>

<script>
//bool for finish game, to set scoreboard
let final = 0;
//to temp hold player name
let playerName = "";

function submitName(){

playerName = document.getElementById("name").value;
//requests /name, index.js has post to save values 
fetch('/name', {
	headers: {
		  'Accept': 'application/json',
		  'Content-Type': 'application/json'
	},
	method: "POST",
	body: JSON.stringify({

		name: playerName,

	})
})
.then(function(res){ console.log(res) })
.catch(function(res){ console.log(res) });

}

fetch('/finallvl', {
		headers: {
			'Accept': 'application/json',
			'Content-Type': 'application/json'
		},
		method: "GET"})
	.then(res => res.json())
	.then(data => { 
		const { finalbool } = data;
	//	console.log(playerName);

	final = finalbool;


	})
	.catch(function(res){ console.log(res) });


if(final = 1){
	
	fetch('/write', {
		headers: {
			'Accept': 'application/json',
			'Content-Type': 'application/json'
		},
		method: "GET"})
	.then(res => res.json())
	.then(data => { 
		const { playerName, lvl3sScore, lvl2sScore } = data;
	//	console.log(playerName);
		var table = document.getElementById('scoreboard');

		var row = table.insertRow(1);

		var cell1 = row.insertCell(0);

		var cell2 = row.insertCell(1);

		var cell3 = row.insertCell(2);

		cell1.innerHTML = playerName;
		cell2.innerHTML = lvl2sScore;
		cell3.innerHTML = lvl3sScore;

	})
	.catch(function(res){ console.log(res) });
}

fetch('/scores', {
		headers: {
			'Accept': 'application/json',
			'Content-Type': 'application/json'
		},
		method: "GET"})
	.then(res => res.json())
	.then(data => { 

		for(item of data){

		var table = document.getElementById('scoreboard');

		var row = table.insertRow(1);

		var cell1 = row.insertCell(0);

		var cell2 = row.insertCell(1);

		var cell3 = row.insertCell(2);

		cell1.textContent = `${item.name}`;

		cell2.innerHTML = `${item.lvl2}`;

		cell3.innerHTML = `${item.lvl3}`;

		}

	})
	.catch(function(res){ console.log(res) });

</script>
